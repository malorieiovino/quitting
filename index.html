<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sobriety Streak Tracker</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #8e44ad;
            --secondary: #9b59b6;
            --accent: #3498db;
            --success: #27ae60;
            --background: #f5f6fa;
            --card-bg: #ffffff;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--background);
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(142, 68, 173, 0.1) 0%, transparent 200px),
                radial-gradient(circle at 80% 70%, rgba(52, 152, 219, 0.1) 0%, transparent 200px);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: var(--primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
            margin-top: 0;
        }
        
        .streak-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .streak-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        
        .streak-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }
        
        .streak-number {
            font-size: 90px;
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
            line-height: 1;
            position: relative;
            display: inline-block;
        }
        
        .streak-number::after {
            content: attr(data-days);
            position: absolute;
            bottom: 10px;
            right: -40px;
            font-size: 24px;
            color: var(--accent);
            font-weight: normal;
        }
        
        .streak-label {
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 16px;
            color: var(--text-secondary);
            margin: 5px 0 15px;
        }
        
        .progress-wrapper {
            margin: 25px 0;
            position: relative;
        }
        
        .progress-bar {
            height: 12px;
            background-color: #f1f1f1;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), var(--accent));
            border-radius: 6px;
            transition: width 1s ease-in-out;
            position: relative;
        }
        
        .milestone-badge {
            display: inline-block;
            padding: 8px 16px;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            color: white;
            border-radius: 50px;
            font-weight: bold;
            margin: 15px 0;
            box-shadow: 0 5px 15px rgba(142, 68, 173, 0.3);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(142, 68, 173, 0.6);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(142, 68, 173, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(142, 68, 173, 0);
            }
        }
        
        .achievement-icons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 15px 0;
        }
        
        .achievement {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: #f1f1f1;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 20px;
            transition: all 0.3s ease;
        }
        
        .achievement.unlocked {
            background: linear-gradient(45deg, var(--success), var(--accent));
            color: white;
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
            transform: scale(1.1);
        }
        
        .button-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
        }
        
        button {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        button.reset {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }
        
        .stats-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 30px;
        }
        
        .stat-card {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--accent);
            margin: 10px 0 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .motivational-quote {
            text-align: center;
            font-style: italic;
            color: var(--text-secondary);
            margin: 30px 0;
            padding: 15px;
            border-left: 4px solid var(--primary);
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 5px;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            animation: fall 3s ease-in infinite;
            opacity: 0;
        }
        
        @keyframes fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(500px) rotate(360deg);
                opacity: 0;
            }
        }
        
        @media (max-width: 480px) {
            .streak-number {
                font-size: 70px;
            }
            
            .streak-number::after {
                right: -30px;
                font-size: 18px;
            }
            
            .stats-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .button-container {
                flex-direction: column;
                gap: 10px;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Sobriety Streak</h1>
            <p class="subtitle">Tracking your progress, celebrating your strength</p>
        </div>
        
        <div class="streak-card">
            <div class="streak-number" id="streak" data-days="DAYS">0</div>
            <p class="streak-label">Clean & Strong</p>
            
            <div class="progress-wrapper">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
                </div>
            </div>
            
            <div id="milestone-container"></div>
            
            <div class="achievement-icons">
                <div class="achievement" id="achievement-1-day" title="1 Day"><i class="fas fa-seedling"></i></div>
                <div class="achievement" id="achievement-7-days" title="1 Week"><i class="fas fa-leaf"></i></div>
                <div class="achievement" id="achievement-30-days" title="1 Month"><i class="fas fa-tree"></i></div>
                <div class="achievement" id="achievement-90-days" title="3 Months"><i class="fas fa-mountain"></i></div>
                <div class="achievement" id="achievement-365-days" title="1 Year"><i class="fas fa-award"></i></div>
            </div>
            
            <div class="button-container">
                <button id="editButton"><i class="fas fa-calendar-alt"></i> Edit Start Date</button>
                <button id="resetButton" class="reset"><i class="fas fa-redo-alt"></i> Reset Streak</button>
            </div>
        </div>
        
        <div class="stats-container">
            <div class="stat-card">
                <i class="fas fa-trophy" style="color: #f1c40f; font-size: 24px;"></i>
                <div class="stat-value" id="longest-streak">0</div>
                <div class="stat-label">Longest Streak</div>
            </div>
            <div class="stat-card">
                <i class="fas fa-calendar-check" style="color: #3498db; font-size: 24px;"></i>
                <div class="stat-value" id="total-days">0</div>
                <div class="stat-label">Total Days Clean</div>
            </div>
        </div>
        
        <div class="motivational-quote" id="motivational-quote">
            "Every day is a new opportunity to grow stronger, to live better, to love more." 
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const streakElement = document.getElementById('streak');
            const progressFill = document.getElementById('progress-fill');
            const milestoneContainer = document.getElementById('milestone-container');
            const editButton = document.getElementById('editButton');
            const resetButton = document.getElementById('resetButton');
            const longestStreakElement = document.getElementById('longest-streak');
            const totalDaysElement = document.getElementById('total-days');
            const quoteElement = document.getElementById('motivational-quote');
            
            // Achievement elements
            const achievement1Day = document.getElementById('achievement-1-day');
            const achievement7Days = document.getElementById('achievement-7-days');
            const achievement30Days = document.getElementById('achievement-30-days');
            const achievement90Days = document.getElementById('achievement-90-days');
            const achievement365Days = document.getElementById('achievement-365-days');
            
            // Milestone definitions with emojis and fun messages
            const milestones = [
                { days: 1, message: "First day complete! 🎉 The journey of a thousand miles begins with a single step!" },
                { days: 3, message: "3 days strong! 💪 The hardest part is behind you!" },
                { days: 7, message: "One week milestone! 🌟 Your brain chemistry is already thanking you!" },
                { days: 14, message: "Two weeks of freedom! 🦋 You're breaking those chains!" },
                { days: 21, message: "21 days! 🌱 New habits are taking root!" },
                { days: 30, message: "ONE MONTH CLEAN! 🏆 That's major progress!" },
                { days: 60, message: "60 DAYS! 🚀 You're absolutely crushing this!" },
                { days: 90, message: "90 DAYS! 🌈 Your mind and body are healing in amazing ways!" },
                { days: 180, message: "HALF A YEAR! 💎 What an incredible achievement!" },
                { days: 365, message: "ONE FULL YEAR! 👑 You're an absolute legend!" }
            ];
            
            // Motivational quotes
            const quotes = [
                "Every day is a new opportunity to grow stronger, to live better, to love more.",
                "The only person you should try to be better than is the person you were yesterday.",
                "Your potential is endless. Go do what you were created to do.",
                "Fall seven times, stand up eight.",
                "You are never too old to set another goal or dream a new dream.",
                "The journey of a thousand miles begins with one step.",
                "The struggle you're in today is developing the strength you need for tomorrow.",
                "Don't count the days, make the days count.",
                "Recovery is hard. Regret is harder.",
                "Progress, not perfection.",
                "You didn't come this far to only come this far.",
                "The best time to plant a tree was 20 years ago. The second best time is now.",
                "Believe you can and you're halfway there.",
                "What lies behind us and what lies before us are tiny matters compared to what lies within us.",
                "When everything seems to be going against you, remember that the airplane takes off against the wind, not with it."
            ];
            
            // History of streaks
            let streakHistory = JSON.parse(localStorage.getItem('streakHistory')) || [];
            
            // Load data
            let startDate = localStorage.getItem('sobrietyStartDate');
            let streakCount = 0;
            let longestStreak = parseInt(localStorage.getItem('longestStreak')) || 0;
            let totalDays = parseInt(localStorage.getItem('totalDays')) || 0;
            
            // Set a random quote
            function setRandomQuote() {
                const randomIndex = Math.floor(Math.random() * quotes.length);
                quoteElement.textContent = `"${quotes[randomIndex]}"`;
            }
            
            // Create confetti effect
            function createConfetti(count = 50) {
                const container = document.querySelector('.streak-card');
                
                for (let i = 0; i < count; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    
                    // Random position, color and delay
                    const left = Math.random() * 100;
                    const color = `hsl(${Math.random() * 360}, 80%, 60%)`;
                    const delay = Math.random() * 3;
                    
                    confetti.style.left = `${left}%`;
                    confetti.style.backgroundColor = color;
                    confetti.style.animationDelay = `${delay}s`;
                    
                    container.appendChild(confetti);
                    
                    // Remove after animation completes
                    setTimeout(() => {
                        confetti.remove();
                    }, 3000 + (delay * 1000));
                }
            }
            
            // Update achievements based on streak
            function updateAchievements() {
                // Reset all
                achievement1Day.classList.remove('unlocked');
                achievement7Days.classList.remove('unlocked');
                achievement30Days.classList.remove('unlocked');
                achievement90Days.classList.remove('unlocked');
                achievement365Days.classList.remove('unlocked');
                
                // Unlock based on streak
                if (streakCount >= 1) achievement1Day.classList.add('unlocked');
                if (streakCount >= 7) achievement7Days.classList.add('unlocked');
                if (streakCount >= 30) achievement30Days.classList.add('unlocked');
                if (streakCount >= 90) achievement90Days.classList.add('unlocked');
                if (streakCount >= 365) achievement365Days.classList.add('unlocked');
            }
            
            // Calculate streak if start date exists
            if (startDate) {
                const start = new Date(startDate);
                const today = new Date();
                
                // Reset to beginning of day for accurate calculation
                start.setHours(0, 0, 0, 0);
                today.setHours(0, 0, 0, 0);
                
                // Calculate difference in days
                const diffTime = today.getTime() - start.getTime();
                streakCount = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                
                // Update streak display
                updateDisplay();
            }
            
            // Set random quote on load
            setRandomQuote();
            
            // Calculate next milestone for progress bar
            function getNextMilestone() {
                const nextMilestone = milestones.find(m => m.days > streakCount);
                if (nextMilestone) {
                    return nextMilestone.days;
                }
                // If beyond all milestones, use 365 (1 year) as reference
                return 365;
            }
            
            // Update all display elements
            function updateDisplay() {
                streakElement.textContent = streakCount;
                
                // Update progress bar
                const nextMilestoneDay = getNextMilestone();
                const progress = Math.min(100, (streakCount / nextMilestoneDay) * 100);
                progressFill.style.width = `${progress}%`;
                
                // Check for milestone
                const currentMilestone = milestones.filter(m => m.days <= streakCount).pop();
                const nextMilestone = milestones.find(m => m.days > streakCount);
                
                // Clear previous milestone
                milestoneContainer.innerHTML = '';
                
                // Show next milestone or current if it's the exact day
                if (nextMilestone) {
                    const daysToNext = nextMilestone.days - streakCount;
                    if (daysToNext === 0) {
                        milestoneContainer.innerHTML = `<div class="milestone-badge">${nextMilestone.message}</div>`;
                        createConfetti();
                    } else {
                        milestoneContainer.innerHTML = `<div class="milestone-badge">${daysToNext} days until ${nextMilestone.days}-day milestone!</div>`;
                    }
                } else if (currentMilestone && currentMilestone.days === streakCount) {
                    milestoneContainer.innerHTML = `<div class="milestone-badge">${currentMilestone.message}</div>`;
                    createConfetti();
                }
                
                // Update achievements
                updateAchievements();
                
                // Update stats
                longestStreakElement.textContent = Math.max(longestStreak, streakCount);
                totalDaysElement.textContent = totalDays + streakCount;
            }
            
            // Edit start date button
            editButton.addEventListener('click', function() {
                const existingDate = startDate ? new Date(startDate).toISOString().split('T')[0] : '';
                const newDate = prompt(`Enter your sobriety start date (YYYY-MM-DD):`, existingDate);
                
                if (newDate && isValidDate(newDate)) {
                    // If there was a previous streak, save it to history
                    if (startDate && streakCount > 0) {
                        const oldStart = new Date(startDate);
                        const oldEnd = new Date();
                        oldEnd.setDate(oldEnd.getDate() - 1); // Yesterday
                        
                        streakHistory.push({
                            start: oldStart.toISOString().split('T')[0],
                            end: oldEnd.toISOString().split('T')[0],
                            days: streakCount
                        });
                        
                        // Update total days
                        totalDays += streakCount;
                        localStorage.setItem('totalDays', totalDays);
                        
                        // Update longest streak
                        if (streakCount > longestStreak) {
                            longestStreak = streakCount;
                            localStorage.setItem('longestStreak', longestStreak);
                        }
                        
                        // Save history
                        localStorage.setItem('streakHistory', JSON.stringify(streakHistory));
                    }
                    
                    // Set new start date
                    startDate = newDate;
                    localStorage.setItem('sobrietyStartDate', startDate);
                    
                    // Recalculate streak
                    const start = new Date(startDate);
                    const today = new Date();
                    start.setHours(0, 0, 0, 0);
                    today.setHours(0, 0, 0, 0);
                    
                    const diffTime = today.getTime() - start.getTime();
                    streakCount = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                    
                    // Set a new random quote
                    setRandomQuote();
                    
                    // Update display
                    updateDisplay();
                } else if (newDate) {
                    alert("Please enter a valid date in YYYY-MM-DD format.");
                }
            });
            
            // Reset streak button
            resetButton.addEventListener('click', function() {
                if (confirm("Are you sure you want to reset your streak? This will save your current streak to history.")) {
                    // Save current streak to history if it exists
                    if (startDate && streakCount > 0) {
                        const oldStart = new Date(startDate);
                        const oldEnd = new Date();
                        oldEnd.setDate(oldEnd.getDate() - 1); // Yesterday
                        
                        streakHistory.push({
                            start: oldStart.toISOString().split('T')[0],
                            end: oldEnd.toISOString().split('T')[0],
                            days: streakCount
                        });
                        
                        // Update total days
                        totalDays += streakCount;
                        localStorage.setItem('totalDays', totalDays);
                        
                        // Update longest streak
                        if (streakCount > longestStreak) {
                            longestStreak = streakCount;
                            localStorage.setItem('longestStreak', longestStreak);
                        }
                        
                        // Save history
                        localStorage.setItem('streakHistory', JSON.stringify(streakHistory));
                    }
                    
                    // Reset start date to today
                    const today = new Date();
                    startDate = today.toISOString().split('T')[0];
                    localStorage.setItem('sobrietyStartDate', startDate);
                    
                    // Reset streak counter
                    streakCount = 0;
                    
                    // Set a new random quote
                    setRandomQuote();
                    
                    // Update display
                    updateDisplay();
                }
            });
            
            // Helper function to validate date format
            function isValidDate(dateString) {
                const regex = /^\d{4}-\d{2}-\d{2}$/;
                if (!regex.test(dateString)) return false;
                
                const date = new Date(dateString);
                return date instanceof Date && !isNaN(date);
            }
            
            // Update achievement tooltips for better mobile experience
            const achievements = document.querySelectorAll('.achievement');
            achievements.forEach(achievement => {
                achievement.addEventListener('click', function() {
                    alert(this.getAttribute('title'));
                });
            });
        });
    </script>
</body>
</html>
